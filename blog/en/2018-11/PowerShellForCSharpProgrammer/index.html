<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/blog/uploads/assets/icon200.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/uploads/assets/icon32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/uploads/assets/icon16.png"><link rel="mask-icon" href="/blog/images/logo.svg" color="#222"><link rel="stylesheet" href="/blog/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"zyxin.xyz","root":"/blog/en/","images":"/blog/en/images","scheme":"Muse","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":{"disqus":{"text":"Disqus Comments"},"livere":{"text":"LiveRe Comments"}},"store":true,"activeClass":"disqus"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/blog/js/config.js"></script><meta name="description" content="This post was written in Chinese and hasn’t been translated to English yet.  PowerShell是微软一个非常棒的产品，终于改变了人们对Windows下命令行的一片鄙视。一直以来都很想学学PowerShell，这样我就不用使用Python作为手边的脚本语言了，对进行一些文件操作、系统操作而言PowerShell还是要比P"><meta property="og:type" content="article"><meta property="og:title" content="PowerShell快速上手（针对有C#经验者）"><meta property="og:url" content="http://zyxin.xyz/blog/2018-11/PowerShellForCSharpProgrammer/index.html"><meta property="og:site_name" content="Jacob Zhong"><meta property="og:description" content="This post was written in Chinese and hasn’t been translated to English yet.  PowerShell是微软一个非常棒的产品，终于改变了人们对Windows下命令行的一片鄙视。一直以来都很想学学PowerShell，这样我就不用使用Python作为手边的脚本语言了，对进行一些文件操作、系统操作而言PowerShell还是要比P"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2018-11-03T02:59:12.000Z"><meta property="article:modified_time" content="2021-10-12T21:12:40.946Z"><meta property="article:author" content="Jacob Zhong"><meta property="article:tag" content="C#"><meta property="article:tag" content="PowerShell"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://zyxin.xyz/blog/2018-11/PowerShellForCSharpProgrammer/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://zyxin.xyz/blog/2018-11/PowerShellForCSharpProgrammer/","path":"2018-11/PowerShellForCSharpProgrammer/","title":"PowerShell快速上手（针对有C#经验者）"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>PowerShell快速上手（针对有C#经验者） | Jacob Zhong</title><noscript><link rel="stylesheet" href="/blog/css/noscript.css"></noscript><link rel="alternate" href="/blog/atom.xml" title="Jacob Zhong" type="application/atom+xml">
</head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/blog/en/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Jacob Zhong</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">b.zyxin.xyz</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/blog/en/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/blog/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/blog/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-sitemap"><a href="/blog/en/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PowerShell%E8%84%9A%E6%9C%AC%E7%9A%84%E8%BF%90%E8%A1%8C%E6%96%B9%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">PowerShell脚本的运行方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-or-%E5%8F%82%E6%95%B0-or-%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%9F"><span class="nav-number">2.</span> <span class="nav-text">命令 or 参数 or 字符串？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#NET%E4%BA%A4%E4%BA%92%EF%BC%88Interop%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">.NET交互（Interop）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PowerShell%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.1.</span> <span class="nav-text">PowerShell对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PowerShell%E4%B8%AD%E6%93%8D%E4%BD%9C-NET%E7%B1%BB"><span class="nav-number">3.2.</span> <span class="nav-text">PowerShell中操作.NET类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">4.</span> <span class="nav-text">操作符</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PowerShell%E2%80%9C%E9%A9%B1%E5%8A%A8%E2%80%9D"><span class="nav-number">5.</span> <span class="nav-text">PowerShell“驱动”</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A9%B1%E5%8A%A8%E7%BB%9F%E4%B8%80%E6%94%AF%E6%8C%81%E7%9A%84%E5%91%BD%E4%BB%A4%E6%8E%A5%E5%8F%A3"><span class="nav-number">5.1.</span> <span class="nav-text">驱动统一支持的命令接口</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Jacob Zhong" src="/blog/uploads/assets/avatar.png"><p class="site-author-name" itemprop="name">Jacob Zhong</p><div class="site-description" itemprop="description">Blog of Jacob Zhong</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/blog/en/archives/"><span class="site-state-item-count">57</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/blog/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/blog/en/tags/"><span class="site-state-item-count">46</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/cmpute" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;cmpute" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://www.linkedin.com/in/jacobzhong/" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;jacobzhong&#x2F;" rel="noopener" target="_blank"><i class="linkedin-square fa-fw"></i>LinkedIn</a> </span><span class="links-of-author-item"><a href="mailto:cmpute@foxmail.com" title="E-Mail → mailto:cmpute@foxmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://www.last.fm/user/cmpute" title="Last.fm → https:&#x2F;&#x2F;www.last.fm&#x2F;user&#x2F;cmpute" rel="noopener" target="_blank"><i class="lastfm-square fa-fw"></i>Last.fm</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Friend Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://hanyuz1996.github.io/" title="https:&#x2F;&#x2F;hanyuz1996.github.io&#x2F;" rel="noopener" target="_blank">Hanyuz</a></li><li class="links-of-blogroll-item"><a href="https://xingminw.github.io/" title="https:&#x2F;&#x2F;xingminw.github.io&#x2F;" rel="noopener" target="_blank">Xingminw</a></li></ul></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="http://zyxin.xyz/blog/2018-11/PowerShellForCSharpProgrammer/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog/en/uploads/assets/avatar.png"><meta itemprop="name" content="Jacob Zhong"><meta itemprop="description" content="Blog of Jacob Zhong"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jacob Zhong"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">PowerShell快速上手（针对有C#经验者）</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2018-11-02 22:59:12" itemprop="dateCreated datePublished" datetime="2018-11-02T22:59:12-04:00">2018-11-02</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2021-10-12 17:12:40" itemprop="dateModified" datetime="2021-10-12T17:12:40-04:00">2021-10-12</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/en/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a> </span>, <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/en/categories/Coding/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Disqus: </span><a title="disqus" href="/blog/2018-11/PowerShellForCSharpProgrammer/#disqus_thread" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018-11/PowerShellForCSharpProgrammer/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><div class="note warning"><p><strong>This post was written in Chinese and hasn’t been translated to English yet.</strong></p></div><p>PowerShell是微软一个非常棒的产品，终于改变了人们对Windows下命令行的一片鄙视。一直以来都很想学学PowerShell，这样我就不用使用Python作为手边的脚本语言了，对进行一些文件操作、系统操作而言PowerShell还是要比Python来的方便。另外由于有不少C#的经验，因此PowerShell能够调用.NET库的特性也能够充分利用起来，并且实际发现C#的经验让我学习PowerShell快了不少（当然使用bash、CMake这些脚本的经验应该也帮上忙了吧）。本文就是一篇针对有C#经验的用户的PowerShell上手教程，当然如果你有F#、IronPython等基于.NET的脚本经验那就更好了。</p><blockquote><p>Note: 后文中PowerShell简称PS。</p></blockquote><h1 id="PowerShell脚本的运行方法">PowerShell脚本的运行方法<a class="header-anchor" href="#PowerShell脚本的运行方法"> ❮</a></h1><p>PowerShell本质是一个脚本环境/脚本语言。在PS中，语句从第一行开始依次执行，而不像普通程序一样会有一个显式的程序入口（Entry），并且PS的每一行命令（语句）都不用使用结尾标志（如C家族的;）。因此PS脚本的编写将会非常直观，想要输出<code>Hello World</code>只需一行语句即可：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span><br></pre></td></tr></table></figure><p>运行一段PS脚本有两种方式，一种是在PS交互命令行中直接将命令输入，例如你可以直接在PS命令行中输入<code>35+2</code>，或者<code>$env:Path.GetType()</code>等复杂语句；另一种则是将脚本写在<code>.ps1</code>文件中，然后运行<code>.ps1</code>文件即可。这与大部分脚本语言运行的方法是一致的。</p><p>需要指出的是Windows下PS脚本运行是受到系统的限制的，默认系统配置下，如果再PowerShell窗口中直接运行<code>.ps1</code>脚本，PS会提示<em>File cannot be loaded because running scripts is disabled on this system.</em>。解决这个问题有两种方式</p><ol><li>将系统中Windows PowerShell执行策略改为“Bypass”，这个可以通过在PS中运行以下命令完成<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Bypass <span class="literal">-Scope</span> CurrentUser</span><br><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Bypass <span class="literal">-Scope</span> <span class="keyword">Process</span>     <span class="comment"># 仅在当前PS进程中生效。</span></span><br></pre></td></tr></table></figure></li><li>使用<code>powershell -noprofile -executionpolicy bypass -file &lt;文件路径&gt; [参数]</code>来运行脚本，这是用户友好的方法。由于该命令可以通过cmd或者PS执行，因此可以通过<code>.bat</code>文件封装这个命令，以达到双击运行的效果。</li></ol><span id="more"></span><h1 id="命令-or-参数-or-字符串？">命令 or 参数 or 字符串？<a class="header-anchor" href="#命令-or-参数-or-字符串？"> ❮</a></h1><p>PowerShell中变量名均以<code>$</code>开头。与bash、CMake风格相似的是，PS中的内容如果不以<code>$</code>或者<code>-</code>开头则默认都是命令或者字符串，例如在<code>echo Hello World</code>这样的语句中，<code>echo</code>是命令，<code>Hello</code>和<code>World</code>都是命令的参数并且都是字符串类型。在PS中，命令/函数的调用有两种形式：</p><ol><li>命令形式：<code>&lt;命令&gt; [参数1] .. [-参数名2 &lt;参数2&gt;] ..</code>，如<code>Get-ChildItem C:\Windows\* -Include *.exe</code>。在这类形式中，参数默认都是字符串，在不含空格时都可以不打引号。这里的命令主要是PS内置的命令（cmdlet）或者别名（alias），通常是一个首字母大写的单词或者用短横连接的两个首字母大写单词。</li><li>函数形式: <code>[对象.]函数(参数1, 参数2, ..)</code>，如<code>&quot;abcd&quot;.Endswith(&quot;cd&quot;)</code>。在这类形式中，参数需要通过引号来明确指定是字符串。通过这样的方法使用的是.NET的函数，写起来就和C#没什么区别。</li></ol><p>另外，PowerShell支持管道，因此对于命令形式来说可以通过<code>&lt;命令1&gt; | &lt;命令2&gt; | ..</code>的形式来进行链式调用并且传递参数，而函数形式就没法进行链式调用了。</p><h1 id="NET交互（Interop）">.NET交互（Interop）<a class="header-anchor" href="#NET交互（Interop）"> ❮</a></h1><p>PowerShell本身是用C#编写的，并且其内部运行环境也是基于.NET的，因此PS与.NET交互十分简单。</p><h2 id="PowerShell对象">PowerShell对象<a class="header-anchor" href="#PowerShell对象"> ❮</a></h2><p>PS中的对象均为.NET中的对象，因此PS变量可以直接当作.NET对象进行操作，例如下列语句：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; <span class="number">123</span>.ToString()           <span class="comment"># 报错，因为123既不是变量也不是命令</span></span><br><span class="line">&gt;&gt; ([<span class="built_in">int</span>]<span class="number">123</span>).ToString()    <span class="comment"># 这里将字符串123转换成了System.Int32变量</span></span><br><span class="line"><span class="number">123</span></span><br><span class="line">&gt;&gt; (<span class="built_in">Dir</span> C:\).GetType().Name</span><br><span class="line">Object[]</span><br><span class="line">&gt;&gt; (<span class="built_in">Get-Item</span> HKCU:\Software).GetType().FullName</span><br><span class="line">Microsoft.Win32.RegistryKey</span><br></pre></td></tr></table></figure><p>PS不仅能操作对象，还能够直接创建对象</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PS中创建.NET对象</span></span><br><span class="line">&gt;&gt; <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Version <span class="literal">-ArgumentList</span> <span class="string">&quot;1.2.3.4&quot;</span></span><br><span class="line">Major  Minor  Build  Revision</span><br><span class="line">-----  -----  -----  --------</span><br><span class="line"><span class="number">1</span>      <span class="number">2</span>      <span class="number">3</span>      <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PowerShell中的Object对象操作</span></span><br><span class="line">&gt;&gt; <span class="variable">$var</span> = <span class="built_in">New-Object</span> object</span><br><span class="line">&gt;&gt; <span class="variable">$var</span>.GetType().Name      </span><br><span class="line">System.Object</span><br><span class="line">&gt;&gt; <span class="built_in">Add-Member</span> <span class="literal">-InputObject</span> <span class="variable">$var</span> <span class="literal">-Name</span> Value <span class="literal">-Value</span> <span class="number">123</span> <span class="literal">-MemberType</span> NoteProperty</span><br><span class="line">&gt;&gt; <span class="variable">$var</span>.Value</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure><p>通过<code>Add-Member</code>和<code>Get-Member</code>命令，PS不仅能够完成.NET中的反射（Reflection），还能够完成类似匿名对象（Anonymous Object）的创建，这个十分有用！</p><h2 id="PowerShell中操作-NET类">PowerShell中操作.NET类<a class="header-anchor" href="#PowerShell中操作-NET类"> ❮</a></h2><p>在PS中可以直接调用.NET库中的类进行操作</p><ol><li>新建对象：<code>New-Object -TypeName System.Version -ArgumentList &quot;1.2.3.4&quot;</code></li><li>强制转换：<code>[int]&quot;1234&quot;</code>（等同于<code>[System.Int32]&quot;1234&quot;</code>）</li><li>调用静态函数： <code>[System.DateTime]::Parse(&quot;2012-10-13 23:42:55&quot;)</code><br>有了这些操作，PowerShell已经完全可以当一个C#脚本引擎了~</li></ol><h1 id="操作符"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_operators">操作符</a><a class="header-anchor" href="#操作符"> ❮</a></h1><p>在利用PS写逻辑流程时就会发现，除了加减乘除外，C#的很多关键字和操作符都不能直接使用。在PS中，这些操作符都变成了命令或者以<code>-</code>开头的命令符了。下表列出了常用的操作符：</p><table><thead><tr><th>类型</th><th>PS操作符</th><th>C#操作符</th></tr></thead><tbody><tr><td><a target="_blank" rel="noopener" href="https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_comparison_operators"><strong>比较</strong></a></td><td><code>-eq</code></td><td><code>==</code></td></tr><tr><td>比较</td><td><code>-ne</code></td><td><code>!=</code></td></tr><tr><td>比较</td><td><code>-gt</code></td><td><code>&gt;</code></td></tr><tr><td>比较</td><td><code>-ge</code></td><td><code>&gt;=</code></td></tr><tr><td>比较</td><td><code>-lt</code></td><td><code>&lt;</code></td></tr><tr><td>比较</td><td><code>-le</code></td><td><code>&lt;=</code></td></tr><tr><td><a target="_blank" rel="noopener" href="https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_type_operators"><strong>类型</strong></a></td><td><code>-is</code></td><td><code>is</code></td></tr><tr><td>类型</td><td><code>-as</code></td><td><code>as</code></td></tr><tr><td><a target="_blank" rel="noopener" href="https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_logical_operators"><strong>逻辑</strong></a></td><td><code>-and</code></td><td><code>&amp;&amp;</code></td></tr><tr><td>逻辑</td><td><code>-or</code></td><td><code>||</code></td></tr><tr><td>逻辑</td><td><code>-xor</code></td><td><code>^</code></td></tr><tr><td>逻辑</td><td><code>-not</code></td><td><code>!</code></td></tr><tr><td><a target="_blank" rel="noopener" href="https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_arithmetic_operators"><strong>运算</strong></a></td><td><code>-band</code></td><td><code>&amp;</code></td></tr><tr><td>运算</td><td><code>-bnot</code></td><td><code>~</code></td></tr><tr><td>运算</td><td><code>-bor</code></td><td><code>|</code></td></tr><tr><td>运算</td><td><code>-bxor</code></td><td><code>^</code></td></tr><tr><td>运算</td><td><code>-shl</code></td><td><code>&lt;&lt;</code></td></tr><tr><td>运算</td><td><code>-shr</code></td><td><code>&gt;&gt;</code></td></tr><tr><td>运算</td><td><code>-bxor</code></td><td><code>^</code></td></tr></tbody></table><blockquote><p>另外需要注意的是<code>&gt;</code>、<code>&gt;&gt;</code>等等运算符在PS中是重定向运算符。</p></blockquote><p>尽管名字不一样，但是这些操作符的用法还是一样的。另外PS中还定义了一些.NET中没有的操作符，这些操作符通常很实用，如：</p><ul><li><code>-contains</code>：返回集合包含元素</li><li><code>-in</code>：返回元素是否被集合包含</li><li><code>-like</code>: 返回字符串是否与通配式匹配（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Wildcard_character">Wildcard Pattern</a>）</li><li><code>-match</code>: 返回字符串是否与正则表达式匹配（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Regular_expression">Regex</a>）</li><li><code>-f</code>: 等价于<code>String.Format()</code></li></ul><h1 id="PowerShell“驱动”"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/powershell/scripting/getting-started/cookbooks/managing-windows-powershell-drives">PowerShell“驱动”</a><a class="header-anchor" href="#PowerShell“驱动”"> ❮</a></h1><p>“驱动”（Drive）是PowerShell中很有意思的一个概念，PowerShell提供了一种统一的接口来管理层次信息系统，包括文件系统（FileSystem）、注册表（Registry）、证书（Certificate）、环境变量（Environment），甚至包括当前会话的变量（Variable）和函数（Function）。这些“Drive”支持统一的一套接口，这就非常的有趣了233。</p><p>通过<code>Get-PSDrive</code>命令我们可以获得当前PowerShell会话支持的驱动，在我的电脑上该命令的运行结果如下（省去部分内容）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Name         Provider      Root </span><br><span class="line">----         --------      ---- </span><br><span class="line">Alias        Alias</span><br><span class="line">C            FileSystem    C:\  </span><br><span class="line">Cert         Certificate   \</span><br><span class="line">D            FileSystem    D:\</span><br><span class="line">E            FileSystem    E:\</span><br><span class="line">Env          Environment</span><br><span class="line">Function     Function</span><br><span class="line">G            FileSystem    G:\</span><br><span class="line">HKCU         Registry      HKEY_CURRENT_USER</span><br><span class="line">HKLM         Registry      HKEY_LOCAL_MACHINE</span><br><span class="line">Variable     Variable</span><br><span class="line">WSMan        WSMan</span><br></pre></td></tr></table></figure><p>通过这些驱动，<code>ls env:\Path</code>就能够获取系统环境变量，<code>HKCU:\SOFTWARE</code>就可以获取注册表键，十分方便。但是需要注意的是这些驱动获得的对象的类型是不同的，如文件对象会是<code>System.IO.FileInfo</code>，而注册表键则是<code>Microsoft.Win32.RegistryKey</code>。</p><h2 id="驱动统一支持的命令接口">驱动统一支持的命令接口<a class="header-anchor" href="#驱动统一支持的命令接口"> ❮</a></h2><table><thead><tr><th>Cmdlet</th><th>Alias</th><th>用途</th></tr></thead><tbody><tr><td>Get-ChildItem</td><td>dir, ls</td><td>获取当前位置的所有子项</td></tr><tr><td>Set-Location</td><td>cd</td><td>更改当前位置</td></tr><tr><td>New-Item</td><td>md, mkdir</td><td>在指定位置新建对象</td></tr><tr><td>Get-Item</td><td></td><td>获取该位置对应的对象</td></tr><tr><td>Remove-Item</td><td>del, rm</td><td>删除指定位置的对象</td></tr><tr><td>New-ItemProperty</td><td></td><td>新建对象的属性</td></tr><tr><td>Get-ItemProperty</td><td></td><td>获取对象的属性（如文件属性，注册表键）</td></tr><tr><td>Set-ItemProperty</td><td></td><td>设置对象的属性</td></tr><tr><td>Clear-ItemProperty</td><td></td><td>删除对象的属性</td></tr><tr><td>Test-Path</td><td></td><td>判断指定位置是否存在对象</td></tr></tbody></table><hr>看完这些内容以后你就可以像写C#一样开始写PowerShell啦。更加详细的教程可以参见下方的参考资料~<blockquote><p><strong>参考资料</strong></p><ul><li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/powershell/">微软官方文档</a></li><li><a target="_blank" rel="noopener" href="https://www.pstips.net/powershell-online-tutorials">PowerShell在线教程</a></li></ul></blockquote></div><footer class="post-footer"><div class="reward-container"><div>Treat me some coffee XD</div><button>Donate</button><div class="post-reward"><div><img src="/blog/uploads/assets/wechatpay.jpg" alt="Jacob Zhong WeChat Pay"> <span>WeChat Pay</span></div><div><img src="/blog/uploads/assets/alipay.jpg" alt="Jacob Zhong Alipay"> <span>Alipay</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>Post author: </strong>Jacob Zhong</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://zyxin.xyz/blog/2018-11/PowerShellForCSharpProgrammer/" title="PowerShell快速上手（针对有C#经验者）">http://zyxin.xyz/blog/2018-11/PowerShellForCSharpProgrammer/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="post-tags"><a href="/blog/en/tags/C/" rel="tag"># C#</a> <a href="/blog/en/tags/PowerShell/" rel="tag"># PowerShell</a></div><div class="post-nav"><div class="post-nav-item"><a href="/blog/en/2018-11/AddGDriveToExplorer/" rel="prev" title="将Google Drive (File Stream)添加到文件管理器左侧空间"><i class="fa fa-chevron-left"></i> 将Google Drive (File Stream)添加到文件管理器左侧空间</a></div><div class="post-nav-item"><a href="/blog/en/2018-11/BrandNewRig/" rel="next" title="My First Rig （Ryzen 2700 + GTX 1070 Ti）">My First Rig （Ryzen 2700 + GTX 1070 Ti） <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="tabs tabs-comment"><ul class="nav-tabs"><li class="tab"><a href="#comment-disqus">Disqus Comments</a></li><li class="tab"><a href="#comment-livere">LiveRe Comments</a></li></ul><div class="tab-content"><div class="tab-pane disqus" id="comment-disqus"><div class="comments" id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></div><div class="tab-pane livere" id="comment-livere"><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC81NDQ2Ni8zMDkzNw=="></div></div></div></div></div></main><footer class="footer"><div class="footer-inner"><div class="languages"><label class="lang-select-label"><i class="fa fa-language"></i> <span>English</span> <i class="fa fa-angle-up" aria-hidden="true"></i></label> <select class="lang-select" data-canonical="" aria-label="Select language"><option value="en" data-href="/blog/2018-11/PowerShellForCSharpProgrammer/" selected>English</option><option value="zh-CN" data-href="/blog/zh-CN/2018-11/PowerShellForCSharpProgrammer/" selected>简体中文</option></select></div><div class="copyright">&copy; 2017 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fire"></i> </span><span class="author" itemprop="copyrightHolder">Jacob Zhong</span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script><script src="/blog/js/pjax.js"></script><script src="/blog/js/third-party/pace.js"></script><script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script><script src="/blog/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"jacob-zhongs-blog","count":true,"i18n":{"disqus":"disqus"}}</script><script src="/blog/js/third-party/comments/disqus.js"></script><script src="/blog/js/third-party/comments/livere.js"></script></body></html>