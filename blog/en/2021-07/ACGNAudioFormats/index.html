<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/blog/uploads/assets/icon200.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/uploads/assets/icon32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/uploads/assets/icon16.png"><link rel="mask-icon" href="/blog/images/logo.svg" color="#222"><link rel="stylesheet" href="/blog/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"zyxin.xyz","root":"/blog/en/","images":"/blog/en/images","scheme":"Muse","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":{"disqus":{"text":"Disqus Comments"},"livere":{"text":"LiveRe Comments"}},"store":true,"activeClass":"disqus"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/blog/js/config.js"></script><meta name="description" content="This post was written in Chinese and hasn’t been translated to English yet.  在我的收藏里面，音乐是占大头的。我非常喜欢尝试各种风格的音乐，也非常喜欢日本音乐圈的多样性，因此收集了很多。在这过程中也了解到了一些音频格式的内容～我也自己做过一个 benchmark，比较不同音频编码的性能区别，如果有兴趣的话可以自己尝试一下～"><meta property="og:type" content="article"><meta property="og:title" content="ACGN 收藏 - 音频编码与格式"><meta property="og:url" content="http://zyxin.xyz/blog/2021-07/ACGNAudioFormats/index.html"><meta property="og:site_name" content="Jacob Zhong"><meta property="og:description" content="This post was written in Chinese and hasn’t been translated to English yet.  在我的收藏里面，音乐是占大头的。我非常喜欢尝试各种风格的音乐，也非常喜欢日本音乐圈的多样性，因此收集了很多。在这过程中也了解到了一些音频格式的内容～我也自己做过一个 benchmark，比较不同音频编码的性能区别，如果有兴趣的话可以自己尝试一下～"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://github.com/cmpute/audio-codec-benchmark/raw/master/figs/PLight_-_Bass_tek_2.wav.lossy_err.jpg"><meta property="article:published_time" content="2021-07-21T03:26:42.000Z"><meta property="article:modified_time" content="2021-10-30T01:42:52.576Z"><meta property="article:author" content="Jacob Zhong"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://github.com/cmpute/audio-codec-benchmark/raw/master/figs/PLight_-_Bass_tek_2.wav.lossy_err.jpg"><link rel="canonical" href="http://zyxin.xyz/blog/2021-07/ACGNAudioFormats/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://zyxin.xyz/blog/2021-07/ACGNAudioFormats/","path":"2021-07/ACGNAudioFormats/","title":"ACGN 收藏 - 音频编码与格式"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>ACGN 收藏 - 音频编码与格式 | Jacob Zhong</title><noscript><link rel="stylesheet" href="/blog/css/noscript.css"></noscript><link rel="alternate" href="/blog/atom.xml" title="Jacob Zhong" type="application/atom+xml">
</head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/blog/en/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Jacob Zhong</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">b.zyxin.xyz</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/blog/en/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/blog/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/blog/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-sitemap"><a href="/blog/en/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9F%B3%E9%A2%91%E4%BF%A1%E5%8F%B7%E8%B0%83%E5%88%B6"><span class="nav-number">1.</span> <span class="nav-text">音频信号调制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%89%E6%8D%9F%EF%BC%88Lossy%EF%BC%89%E7%BC%96%E7%A0%81"><span class="nav-number">2.</span> <span class="nav-text">有损（Lossy）编码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MP3"><span class="nav-number">2.1.</span> <span class="nav-text">MP3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AAC"><span class="nav-number">2.2.</span> <span class="nav-text">AAC</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%A0%E6%8D%9F%EF%BC%88Lossless%EF%BC%89%E7%BC%96%E7%A0%81"><span class="nav-number">3.</span> <span class="nav-text">无损（Lossless）编码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#FLAC"><span class="nav-number">3.1.</span> <span class="nav-text">FLAC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#APE-TAK"><span class="nav-number">3.2.</span> <span class="nav-text">APE&#x2F;TAK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WavPack"><span class="nav-number">3.3.</span> <span class="nav-text">WavPack</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B7%B7%E5%90%88%EF%BC%88Hybrid%EF%BC%89%E7%BC%96%E7%A0%81"><span class="nav-number">4.</span> <span class="nav-text">混合（Hybrid）编码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#LossyWAV"><span class="nav-number">4.1.</span> <span class="nav-text">LossyWAV</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WavPack-2"><span class="nav-number">4.2.</span> <span class="nav-text">WavPack</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Jacob Zhong" src="/blog/uploads/assets/avatar.png"><p class="site-author-name" itemprop="name">Jacob Zhong</p><div class="site-description" itemprop="description">Blog of Jacob Zhong</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/blog/en/archives/"><span class="site-state-item-count">58</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/blog/en/categories/"><span class="site-state-item-count">17</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/blog/en/tags/"><span class="site-state-item-count">48</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/cmpute" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;cmpute" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://www.linkedin.com/in/jacobzhong/" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;jacobzhong&#x2F;" rel="noopener" target="_blank"><i class="linkedin-square fa-fw"></i>LinkedIn</a> </span><span class="links-of-author-item"><a href="mailto:cmpute@foxmail.com" title="E-Mail → mailto:cmpute@foxmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://www.last.fm/user/cmpute" title="Last.fm → https:&#x2F;&#x2F;www.last.fm&#x2F;user&#x2F;cmpute" rel="noopener" target="_blank"><i class="lastfm-square fa-fw"></i>Last.fm</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Friend Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://hanyuz1996.github.io/" title="https:&#x2F;&#x2F;hanyuz1996.github.io&#x2F;" rel="noopener" target="_blank">Hanyuz</a></li><li class="links-of-blogroll-item"><a href="https://xingminw.github.io/" title="https:&#x2F;&#x2F;xingminw.github.io&#x2F;" rel="noopener" target="_blank">Xingminw</a></li></ul></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="http://zyxin.xyz/blog/2021-07/ACGNAudioFormats/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog/en/uploads/assets/avatar.png"><meta itemprop="name" content="Jacob Zhong"><meta itemprop="description" content="Blog of Jacob Zhong"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jacob Zhong"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ACGN 收藏 - 音频编码与格式</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-07-20 23:26:42" itemprop="dateCreated datePublished" datetime="2021-07-20T23:26:42-04:00">2021-07-20</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2021-10-29 21:42:52" itemprop="dateModified" datetime="2021-10-29T21:42:52-04:00">2021-10-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/en/categories/ACGN/" itemprop="url" rel="index"><span itemprop="name">ACGN</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Disqus: </span><a title="disqus" href="/blog/2021-07/ACGNAudioFormats/#disqus_thread" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021-07/ACGNAudioFormats/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><div class="note warning"><p><strong>This post was written in Chinese and hasn’t been translated to English yet.</strong></p></div><p>在我的收藏里面，音乐是占大头的。我非常喜欢尝试各种风格的音乐，也非常喜欢日本音乐圈的多样性，因此收集了很多。在这过程中也了解到了一些音频格式的内容～我也<a target="_blank" rel="noopener" href="https://github.com/cmpute/audio-codec-benchmark">自己做过一个 benchmark</a>，比较不同音频编码的性能区别，如果有兴趣的话可以自己尝试一下～。</p><p>我个人喜欢收藏无损音乐，目的不仅仅是因为高音质，而是无损意味着 “无损”，音质与 CD 或者其他音源是完全一致的（当然，这个一致性音频编码本身并不能保证音源的完整性，但是如果有其他的辅助信息如 EAC log，或者 AccurateRip 测试结果就完全可以保证了）。在这个情况下我把无损压成有损，就能保证这个有损是达到了预期的音质。如果是网上直接下载有损的话，一是很难确定这个有损有没有经过二次压缩，造成额外音质损失，二是有损也最好不要再转换格式了，同样是因为音质损失，这就造成了额外的不便。</p><p>本文就介绍一下我了解的与音频编码相关的知识，以及各种常用音频编码格式的比较。更全面的格式对比可以<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Comparison_of_audio_coding_formats">参考 Wikipedia 页面</a>。另外需要指明的是，本文的介绍基于音乐收藏和本地播放的目的，与流媒体的需求不同，后者追求稳定的码率、低延迟甚至是低能耗。</p><span id="more"></span><h1 id="音频信号调制">音频信号调制<a class="header-anchor" href="#音频信号调制"> ❮</a></h1><blockquote><p>如果学过信号处理的读者可能已经了解本章内容了，可以跳过这节～</p></blockquote><p>在物理世界中，声音本质上是一种物体震动产生的波，如果要将物理世界中的波存储为数字世界可以存储的格式，则需要进行信号采样（模数转换）和信号调制。波形信号调制主要有两种方法，一种是脉冲编码调制（pulse-code modulation，PCM），一种则是脉冲密度调制（pulse-density modulation，PDM）。简而言之 PCM 就是通过数字信号的幅度和频率来分别表示模拟信号的幅度和频率，而 PDM 则通过数字信号的频率和幅度来分别表示模拟信号的幅度和频率（反过来了）。它们对应的音频存储格式是 WAV 和 DSD（Direct Stream Digital），WAV 由于编码简单是最广为使用的音频格式，而 DSD 由于技术和专利的限制则非常罕见，并且音频编辑比 WAV 复杂很多，因此只有在索尼的 SACD 上和一些高清音乐网站可以见到。</p><p>PCM 的音质在频率上受限于其采样率，根据 Nyquist 采样定理，两倍以上的采样率可以真实还原出原波形，所以考虑到人耳的听力最高到 20kHz，通常 PCM 音频的采样率都在 40kHz 以上（如常见的 44.1kHz 和 48kHz）；在振幅上受限于其采样位深。因此采样率低会导致声音高频被裁掉，而采样位深低会导致振幅分辨率下降，音频的动态范围下降，这两者共同导致音频的失真。而 PDM 由于我没学过，就不评价其音质了。</p><p>在不同的采样方式之间是可能会产生额外失真的。高音质采样到低音质采样就不用说了，反过来也是可能的，如非整数倍地改变采样率（如 44.1kHz 到 48kHz），PCM 和 PDM 的转换。位深由于对应的是二进制的位数，非整数倍提高位深不会产生失真。</p><h1 id="有损（Lossy）编码">有损（Lossy）编码<a class="header-anchor" href="#有损（Lossy）编码"> ❮</a></h1><p>首先是有损编码，有损编码的音乐比较好找，因为（天国的）虾米、网易云、Spotify 等网站都可以下到，现在很多平台都提供比较高音质的试听了。但是在曾经的年代，高音质有损编码也是比较难找的，以及现在放在手机上听歌我还是会转换成有损音质。</p><p>不同的有损格式对于 “损失” 音频的哪一部分、哪一频段是不一样的，他们适合的场景也不一样，比如有的格式设计之初的目的就睡尽量保留人声质量。如果真要比较哪种格式、哪种编码器的音质最好的话，只有 A/B 测试才是最可靠的，然而 A/B 测试也会受到被测对象的主观影响，所以如果想选择一个音质最好的编码器的话，可以自行 A/B 测试来做判断。</p><p>有损音频的音质可以通过码率（birate）直接进行优劣判断。音频的码率指的是每秒文件能够提供的信息量，以 CD 音质为例，普通 CD 一般采样率是 <code>44.1kHz</code>（理论能够还原频率高达 <code>22kHz</code> 的波形），采样深度 <code>16bit</code>，双声道，那么原始码率就是 <code>44100*16*2=1141.2kbps</code>，注意这里的 <code>kbps</code> 是 <code>kilo bits per second</code>。普通能下载到的有损音乐通常是 MP3 格式（虽然这年头很少有人再下载音乐了），在我高中那会，从 QQ 音乐等平台上上下载的 MP3 基本都是 128kbps，只有虾米下载的是 192kbps 甚至 320kbps，因此我还是非常喜欢虾米的。</p><p>码率是一个瞬时概念，对于音频编码（甚至视频编码）而言，码率是随时可能变化的。编码器通常提供两种码率控制方法：恒定比特率（Constant BiRate，CBR）和可变比特率（Variable BiRate，VBR）。选择 CBR 或者 VBR 需要试场景而定，CBR 适合稳定的媒体串流，避免网络波动产生播放不畅，而 VBR 由于给了编码器更多空间根据媒体内容调节码率，通常而言可以达到更好的质量，适合本地存储回放。</p><p>一种客观的音质测试方式是直接计算编码后音频与原音频信号相差了多少。根据我的测试，有损音频的质量基本和码率成正比（见下图，如果用信号损失的对数值来看的话几乎是线性正比）。而如果使用<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Weighting_filter#Loudness_measurements_with_weighting_filters">根据人听力敏感度加权</a>之后的频谱，那么可以看出在低码率时（如 96kbps），AAC 的音质较好，这正是 AAC 设计的目标，即在通话音质（一般就是 96kbps）下能够有很好的表现。而在高码率时（如 320kbps）WavPack 和 MP3 CBR 的表现更好，因此很多人说 MP3 格式应该被淘汰，但 320k 的 MP3 的音质还是非常好的。</p><p><img src="https://github.com/cmpute/audio-codec-benchmark/raw/master/figs/PLight_-_Bass_tek_2.wav.lossy_err.jpg" alt="有损音质与码率关系图"></p><p>简而言之，我的结论是在同等码率下各种有损格式的音质都差不多，更应该关注的是如何找到高码率的音源。下面介绍几个主流的有损音频编码格式。（我个人非常喜欢用 WavPack 的有损模式，但是这个很非主流）</p><h2 id="MP3">MP3<a class="header-anchor" href="#MP3"> ❮</a></h2><p>MP3 的名字来源于其最开始是作为 MPEG-1 标准中的第三种音频格式，它应该是（至少在中国）最广为流传的音频编码格式了。而在支持 MP3 的编码器中，<a target="_blank" rel="noopener" href="https://lame.sourceforge.io/">lame</a> 是其中最常用的。MP3 的编码特性是它会根据码率的设置进行低通滤波，320kbps CBR 时滤波在 20kHz 左右比较接近 CD 音质的 22kHz 了，而 192kbps CBR 滤波则在 16kHz 左右，128kbps 在 12KHz 左右。因此不同码率 MP3 的听感区别是非常明显的，通俗来讲音质越差的 MP3 越像是把喇叭蒙在鼓里的声音，各个频段的特点可以<a href="/blog/en/2020-12/AudiophileIntroduction/" title="参考我之前的博客">参考我之前的博客</a>。</p><p><a target="_blank" rel="noopener" href="https://lame.sourceforge.io/">lame 编码器</a>虽然 2012 年之后就几乎没有怎么更新了，但是它应该仍然是所有提供 mp3 的音乐平台使用的主要编码器。它支持 CBR、VBR 和独有的的 ABR。CBR 可以指定码率，VBR 无法直接指定码率，而通过指定参数 <code>-V</code> 来间接实现码率调整，而 ABR 则是在可变码率的同时支持指定一个目标平均码率。</p><p>MP3 虽然是个很古老的格式，并且有不少为人诟病的缺点，但是因为高码率 MP3 的音质确实不错，而且 MP3 的硬件支持非常到位，因此到现在仍然是非常流行的音频格式。</p><h2 id="AAC">AAC<a class="header-anchor" href="#AAC"> ❮</a></h2><p>AAC 全名为 Advanced Audio Coding，AAC 设计目标是成为 MP3 的后继者。虽然维基上说 AAC 在同等码率下能够得到比 MP3 更好的音质，但根据我的测试结果这个结论只在相对较低码率的时候成立。不过 AAC 设计的定位应该就是针对流媒体，以及现在的蓝牙音频，这些地方音频的码率都是受限的，所以也不能说错。AAC 比 MP3 支持更多的采样率、通道数，在视频编码时其实用的非常多，但是其实它不是针对音乐收藏而设计的。</p><p>AAC 音频文件的后缀名通常是 <code>m4a</code> 和 <code>mp4</code>。这两者都是 MPEG-4 标准定义的流媒体容器后缀名，其中前者专门针对音频，而后者则是音频和视频都可以用。关于容器是什么，我会在之后的视频编码器博客中详细介绍。</p><p>AAC 音频编码器除了万能的 ffmpeg 以外，还有以下这些专门针对 AAC 的编码器</p><ul><li><a target="_blank" rel="noopener" href="http://wiki.hydrogenaud.io/index.php?title=Nero_AAC">NeroAAC</a>：质量最好，但是是商用编码器，不开源。</li><li>QuickTime AAC：由苹果设计、应用在 QuickTime 和后来的 iTunes 中、口碑不错。<a target="_blank" rel="noopener" href="https://github.com/nu774/qaac">有第三方开源的实现（qaac）</a>。</li><li><a target="_blank" rel="noopener" href="https://github.com/knik0/faac">FAAC</a>：Free AAC，开源，但是感觉用的人不多</li></ul><p>总的而言，AAC 的特性非常多，也是一个经过深思熟虑后设计的编码器，但由于是针对流媒体设计的，对音频收藏来说并没有什么吸引力。</p><h1 id="无损（Lossless）编码">无损（Lossless）编码<a class="header-anchor" href="#无损（Lossless）编码"> ❮</a></h1><p>无损编码即经过编码压缩之后不会损失信息的编码方式。如果仅仅是为了压缩而言的话，通用的文件压缩理论上也是可以用作音频编码的，但是通用压缩的效率肯定不如专门设计的音频压缩高，并且需要先解压才能播放。无损编码没有音质之差，它们的主要指标则是编码解码耗时，压缩率、对音频格式的支持以及其他附加功能。对音频格式的支持包括多声道（如 5.1）、高采样率和位深（如常见的 Hi-Res 格式 96kHz/24bit）、对 DSD 的支持等。</p><p>下面介绍一些常用的无损格式（其中我选择的就是 WavPack）。</p><h2 id="FLAC">FLAC<a class="header-anchor" href="#FLAC"> ❮</a></h2><p>FLAC 名为 Free Lossless Audio Codec，虽然听起来非常老土和山寨，但应该是目前各平台最通用的格式，像是 MP3 在有损编码里的地位。FLAC 开源、性能好、解码快、硬件支持好、压缩率也不错，无脑选 flac 一般没什么问题。FLAC 是 MPEG 支持的格式，很多高质量的 DVD 和 BD 压缩出来的视频里都会用 FLAC 作为音频编码。因此通常情况下 FLAC 编码音频文件的后缀名是<code>.flac</code>，但有时你也能看到<code>.m4a</code> 的后缀名。</p><h2 id="APE-TAK">APE/TAK<a class="header-anchor" href="#APE-TAK"> ❮</a></h2><p>APE（Monkey’s Audio）和 TAK（Tom’s lossless Audio Kompressor）都是能够提供非常高压缩率的编码器，但是他们俩都是闭源的。在电驴（VeryCD）时代用 APE 的人非常多，可能就是由于其较高的压缩率吧，但是 APE 的编码和解码相当慢。TAK 的编码解码都很快，估计是利用了多线程或者 AVX 加速。另外还有一款编码器叫 OptimFrog，能够提供最高的压缩率，但是编码和解码都奇慢无比，更像是个 Proof of concept 的作品，而且还不开源，实际使用就不要考虑了。</p><h2 id="WavPack">WavPack<a class="header-anchor" href="#WavPack"> ❮</a></h2><p>这里隆重推荐我现在使用的 WavPack。它开源、功能丰富、支持各种采样率位深和通道数，甚至支持 DSD 的编码，这个特性是别无二家了。</p><p>不过最吸引我的功能其实是支持混合编码（见后文）。WavPack 由于其开源的特点，同样被各大音乐软件所支持，甚至 ffmpeg 和 MKV 视频容器都是支持 WavPack 的，不过 MPEG-4 仍然不支持比较遗憾。WavPack 在硬件上支持可能没有 FLAC 广，但是 WavPack 的源码中同样包含了用汇编直接编写的几个核心函数，因此编解码的性能也是非常好的。</p><p>根据我的使用经验，WavPack 有损音质好，无损体积小，编码也快，总之除了 FLAC 之外找 WavPack 就没错了！</p><h1 id="混合（Hybrid）编码">混合（Hybrid）编码<a class="header-anchor" href="#混合（Hybrid）编码"> ❮</a></h1><p>除了有损无损之外还有一种编码方式是混合编码，它指的是编码器在生成有损压缩音频后还生成一个修正文件（Correction File）。当修正文件和本体音频同时存在时原始音频可以被无损还原。这个编码方式的好处是你可以同时拥有大体积的高音质文件和小体积的低音质文件，非常适合我这样的收藏党，文件本体放在云上，然后小体积的有损部分可以经常下载下来听。有损部分也可以用作 demo，如果听了 demo 之后喜欢上这首音乐了再去下载修正文件提高音质。</p><p>支持混合编码的主要有三种音频格式：LossyWav，WavPack 和 OptimFrog，其中最后一种非常难用，而且好像和 LossyWAV 一样不支持无损播放，即需要先解码再播放才能达到无损音质。</p><h2 id="LossyWAV">LossyWAV<a class="header-anchor" href="#LossyWAV"> ❮</a></h2><p>LossyWAV 其实不算是一个完整的音频编码器，而是一个预处理软件。LossyWAV 只能处理原始的 PCM 音频，然后生成的也是 PCM 音频，之后还需要使用其他的（无损）编码器来进行压缩。它的原理是分析原始音频，然后对其进行某种形式的变换使得音频更容易被压缩，从而降低生成的音频文件平均码率。由于这个变换是不可逆的，因此它也是有损压缩，但是 LossyWAV 支持生成修正文件，因此它可以看作一种混合编码方式。</p><p>经过以上描述，相信大家可以看出来编码过程非常麻烦，如果想要生成混合模式下的音频文件和修正文件，需要先从原始 PCM 音频生成有损 PCM 和修正 PCM，然后再分别通过其他方式编码器将它们分别压缩，而无损解码的过程则是把他们反过来。因此 LossyWAV 在编解码速度和文件体积上都完全没有优势，并且这个原理也意味着 LossyWav 不支持无损播放。在能够选择 WavPack 的情况下还是不要用 LossyWAV 了。</p><h2 id="WavPack-2">WavPack<a class="header-anchor" href="#WavPack-2"> ❮</a></h2><p>WavPack 内置对混合模式的支持，而且 WavPack 支持无损播放。这意味着只要播放器能够找到修正文件，那么播放器就能直接以无损音质播放音乐而不需要额外解码。这个特性对我来说就是 killer！另外从前文图表可以看出，WavPack 在有损模式下也能够达到很好的音质水平，甚至在特定码率下比 MP3 和 AAC 都要好。唯一遗憾的地方是混合模式下 WavPack 音频总体的压缩率是比较低的，通常会比无损模式下的体积要高出 5% 左右。不过这个年头存储空间越来越不值钱了，所以这个问题也完全可以忽略。</p><p>总而言之我完全找不到理由不使用 WavPack，再次向大家推荐这个编码器！</p><hr><p>本文介绍了在 ACG 音乐收藏的过程中我了解到的音频编码知识，而在下一篇博客我还会介绍视频编码的内容～</p><blockquote><p>参考资料：</p><ul><li><a target="_blank" rel="noopener" href="https://samplerateconverter.com/educational/dsd-pcm">DSD vs PCM</a></li><li><a target="_blank" rel="noopener" href="https://github.com/cmpute/audio-codec-benchmark">我自己搭的 codec 对比 benchmark</a></li><li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Comparison_of_audio_coding_formats">维基百科对音频格式的对比页面</a></li></ul></blockquote></div><footer class="post-footer"><div class="reward-container"><div>Treat me some coffee XD</div><button>Donate</button><div class="post-reward"><div><img src="/blog/uploads/assets/wechatpay.jpg" alt="Jacob Zhong WeChat Pay"> <span>WeChat Pay</span></div><div><img src="/blog/uploads/assets/alipay.jpg" alt="Jacob Zhong Alipay"> <span>Alipay</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>Post author: </strong>Jacob Zhong</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://zyxin.xyz/blog/2021-07/ACGNAudioFormats/" title="ACGN 收藏 - 音频编码与格式">http://zyxin.xyz/blog/2021-07/ACGNAudioFormats/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="post-nav"><div class="post-nav-item"><a href="/blog/en/2021-07/MegaFavNumbers/" rel="prev" title="MegaFavNumbers - 最喜爱的百万数字"><i class="fa fa-chevron-left"></i> MegaFavNumbers - 最喜爱的百万数字</a></div><div class="post-nav-item"><a href="/blog/en/2021-08/OneLinePerProgrammingLanguage/" rel="next" title="Select Modern Programming Languages by One-line comments">Select Modern Programming Languages by One-line comments <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="tabs tabs-comment"><ul class="nav-tabs"><li class="tab"><a href="#comment-disqus">Disqus Comments</a></li><li class="tab"><a href="#comment-livere">LiveRe Comments</a></li></ul><div class="tab-content"><div class="tab-pane disqus" id="comment-disqus"><div class="comments" id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></div><div class="tab-pane livere" id="comment-livere"><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC81NDQ2Ni8zMDkzNw=="></div></div></div></div></div></main><footer class="footer"><div class="footer-inner"><div class="languages"><label class="lang-select-label"><i class="fa fa-language"></i> <span>English</span> <i class="fa fa-angle-up" aria-hidden="true"></i></label> <select class="lang-select" data-canonical="" aria-label="Select language"><option value="en" data-href="/blog/2021-07/ACGNAudioFormats/" selected>English</option><option value="zh-CN" data-href="/blog/zh-CN/2021-07/ACGNAudioFormats/" selected>简体中文</option></select></div><div class="copyright">&copy; 2017 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fire"></i> </span><span class="author" itemprop="copyrightHolder">Jacob Zhong</span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script><script src="/blog/js/pjax.js"></script><script src="/blog/js/third-party/pace.js"></script><script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script><script src="/blog/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"jacob-zhongs-blog","count":true,"i18n":{"disqus":"disqus"}}</script><script src="/blog/js/third-party/comments/disqus.js"></script><script src="/blog/js/third-party/comments/livere.js"></script></body></html>